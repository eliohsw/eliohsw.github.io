<!-- Footer Placeholder -->
<div id="footer-placeholder"></div>

<!-- Common Scripts -->
<script>
  window.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
      const loader = document.getElementById('loader');
      if (loader) {
        loader.style.opacity = '0';
        loader.style.pointerEvents = 'none';
        setTimeout(() => loader.remove(), 400);
      }
    }, 750);
  });
</script>

<script type="module">
  import { initComponentPlaceholders } from '{{ site.baseurl }}/{{ page.js_ui_loader_path | default: "technical/js/ui-loader.js" }}';
  import { initTheme, initSidebar, initScrollEffects, initCardImageHeights, initCardImagePreview{% if page.include_greeting %}, initGreeting{% endif %}{% if page.include_ripple %}, initRipple{% endif %} } from '{{ site.baseurl }}/{{ page.js_ui_effects_path | default: "technical/js/ui-effects.js" }}';
  
  // Initialize components
  initComponentPlaceholders();
  
  // Function to initialize UI effects
  function initializeUIEffects() {
    if (document.querySelector('.nav-bar')) initScrollEffects();
    if (document.querySelector('.menu-btn') && document.querySelector('.mobile-sidebar')) initSidebar();
    if (document.getElementById('theme-toggle')) initTheme();
    if (document.querySelector('.card-contents')) initCardImageHeights();
    if (document.querySelector('.card-image')) initCardImagePreview();
    {% if page.include_greeting %}
    if (document.getElementById('greeting')) initGreeting();
    {% endif %}
    {% if page.include_ripple %}
    if (document.body) initRipple();
    {% endif %}
  }
  
  {% if page.include_greeting %}
  // Wait for all components to load before initializing UI effects
  document.addEventListener('componentsLoaded', initializeUIEffects);
  
  // Fallback: if componentsLoaded doesn't fire within 6 seconds, try to initialize anyway
  setTimeout(() => {
    if (!document.querySelector('.nav-bar')) {
      console.warn('Components may not have loaded properly - attempting UI initialization anyway');
      initializeUIEffects();
    }
  }, 6000);
  {% else %}
  setTimeout(() => {
    if (document.querySelector('.nav-bar')) initScrollEffects();
    if (document.querySelector('.menu-btn') && document.querySelector('.mobile-sidebar')) initSidebar();
    if (document.getElementById('theme-toggle')) initTheme();
    if (document.querySelector('.card-contents')) initCardImageHeights();
    if (document.querySelector('.card-image')) initCardImagePreview();
  }, 200);
  {% endif %}
</script>

{% if page.additional_scripts %}
  {% for script in page.additional_scripts %}
<script type="module" src="{{ site.baseurl }}/{{ script }}"></script>
  {% endfor %}
{% endif %}
